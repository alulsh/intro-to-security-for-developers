<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>Intro to Security for Developers</title>

        <meta name="description" content="Intro to security for developers, presented at Mapbox Miniconf at DCFemTech Tour de Code 2016">
        <meta name="author" content="Alexandra Ulsh">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <link rel="stylesheet" href="css/reveal.css">
        <link rel="stylesheet" href="css/theme/black.css">

        <!-- Theme used for syntax highlighting of code -->
        <link rel="stylesheet" href="lib/css/zenburn.css">

        <!-- Printing and PDF exports -->
        <script>
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>
    </head>
    <body>
        <div class="reveal">
            <div class="slides">
                <section>
                    <section>
                        <h1>Intro to Security for Developers</h1>
                        <small>Alexandra Ulsh<br/>
                        Mapbox Miniconf<br/>
                        DCFemTech Tour de Code 2016</small>
                    </section>
                    <section data-markdown>
                        ## Overview
                        * About me
                        * Why learn security?
                        * Common security terms
                        * Consumer Security
                        * Developer Tools Security
                        * Application Security
                        * Infrastructure Security
                    </section>
                    <section data-markdown>
                        ## How to: Slides
                        * This presentation uses [reveal.js](https://github.com/hakimel/reveal.js).
                        * Use the left/right arrows to go the next topic and up/down arrows to view the slides.
                        * These slides are available [on my website](http://www.alexandraulsh.com/intro-to-security-for-developers).
                        * To view locally:
                        ```sh
                        git clone git@github.com:alulsh/intro-to-security-for-developers.git
                        git checkout gh-pages
                        cd slides
                        npm install
                        npm start
                        ```
                    </section>
                    <section data-markdown>
                        ## How to: Code Samples

                        * This presentation includes code samples to help teach security concepts interactively.
                        * These must be run locally - they're not on my website.
                        * I use GitHub Pages (can't run Node) and I don't want live vulnerabilities on my domain.
                        * Prerequisites:
                            * [node.js](https://nodejs.org/en/download/) (preferably install using [nvm](https://github.com/creationix/nvm))
                            * [npm](https://docs.npmjs.com/getting-started/installing-node)
                        * I used Node 4.6.0 and npm 2.15.9, but these samples may work with earlier or later versions of either node/npm
                        * I'm using Node and Express (due to familiarity) - I may explore other languages for other talks.
                    </section>
                    <section data-markdown>
                        ## How to: Code Samples
                        * To get a code sample running:
                        ```sh
                        git clone git@github.com:alulsh/intro-to-security-for-developers.git
                        cd &lt;code sample folder&gt;
                        npm install
                        npm start
                        ```
                    </section>
                </section>
                <section>
                    <section>
                        <p><code>&lt;script&gt;alert('whoami?')&lt;/script&gt;</code></p>
                    </section>
                    <section>
                        <p>Alexandra "Alex" Ulsh</p>
                        <p>Information Security Engineer at Mapbox</p>
                        <img src="img/alex-ulsh.jpg"/><br/>
                        <a href="https://www.twitter.com/AlexUlsh">@AlexUlsh</a><br/>
                        <a href="http://www.alexandraulsh.com/">alexandraulsh.com</a>
                    </section>
                    <section>
                        <img src="img/mapbox.jpg"/>
                        <p>I run our bug bounty program on <a href="https://hackerone.com/mapbox">HackerOne</a>, help lock down our AWS infrastructure with open source projects like <a href="">Patrol</a>, and make sure Mapbox team members are using all their devices and accounts securely.</p>
                    </section>
                    <section data-markdown>
                        ## How did I get started in security?
                        * 3.5 years sysadmin for U.S. DoD doing SharePoint administration
                        * Security+ certification required for job
                        * STIGs for SharePoint, IIS, and SQL Server (DIACAP)
                        * Open-sourced PowerShell module to STIG SharePoint
                        * [https://github.com/alulsh/SharePoint-2013-STIGs](https://github.com/alulsh/SharePoint-2013-STIGs)
                    </section>
                    <section data-markdown>
                        ## How can you get started in security?
                        * Learn how to secure your computers, cellphones, and accounts
                        * Learn how to write secure code and deploy secure infrastructure
                        * Learn how hackers attack systems and how to defend against them
                    </section>
                    <section data-markdown>
                        * Check out bug bounty programs on [HackerOne](https://hackerone.com/) and [Bugcrowd](https://bugcrowd.com/)
                        * Teach your friends and coworkers about security
                        * Offer to harden servers and do secure code reviews
                        * Offer to triage bug bounty reports
                        * Think about the ways you or your organization can be hacked, then implement defenses
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        ## Why learn security?
                        * Protect yourself, people you care about, and your organization
                        * Responsibility to protect the security and privacy of the people who use our applications
                        * Solve complex and difficult problems that make a difference
                        * Never boring - threats are constantly changing and evolving
                    </section>
                    <section data-markdown>
                        ### Software engineers

                        > Engineers bear a burden to the public, and their specific expertise as designers and builders of bridges or buildings—or software—emanates from that responsibility. Only after answering this calling does an engineer build anything, whether bridges or buildings or software.

                        ["Programmers: Stop Calling Yourselves Engineers"](http://www.theatlantic.com/technology/archive/2015/11/programmers-should-not-call-themselves-engineers/414271/)

                        The Atlantic
                    </section>
                    <section data-markdown>
                        If we want to call ourselves software **engineers**, then we need to build secure, stable, and reliable software that minimizes harm to others.

                        Furthermore, all people involved in creating software and other computer systems should care about security, stability, privacy, and reliabilty in what we create and maintain.
                    </section>
                    <section data-markdown>
                        ### Diversity in Security
                        * Women make up only 10% of the infosec workforce per an [ISC2 white paper](https://www.boozallen.com/content/dam/boozallen/documents/2015/09/women-in-security.pdf).
                        * Among the infosec workforce, 20% of women serve in GRC (Governance, Risk, &amp; Compliance) roles vs. 12.5% of men.
                        * Only 7% of infosec workforce is black per [DC Inno](http://dcinno.streetwise.co/2016/03/23/lack-of-diversity-minorities-in-cybersecurity-industry-hiring/).
                        * Only 5% of infosec workforce is hispanic per [DC Inno](http://dcinno.streetwise.co/2016/03/23/lack-of-diversity-minorities-in-cybersecurity-industry-hiring/).
                    </section>
                    <section data-markdown>
                        ![97% of HackerOne hackers are male](img/WhoAreHackers.png) 
                    </section>
                    <section data-markdown>
                        ### Diversity of Security Researchers
                        Per [HackerOne 2016 Hacker Report](https://hackerone.com/blog/bug-bounty-hacker-report-2016), 97% of their security researchers are male.

                        Competitor Bug Crowd doesn't even provide gender statistics in their [2016 State of the Bug Bounty Report](https://pages.bugcrowd.com/2016-state-of-bug-bounty-report).
                    </section>
                    <section data-markdown>
                        ### Job opportunities in security

                        ![Stats from MIT Technology Review](img/TalentGap.png)

                        "[Close the Talent Gap, Secure the Future](https://www.technologyreview.com/s/601537/close-the-talent-gap-secure-the-future/)" from MIT Technology Review
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        # Common Security Terms
                    </section>
                    <section data-markdown>
                        ## Types of security
                        * **infosec** = information security
                        * **cybersecurity** vs. **infosec** vs. **information assurance (IA)**
                        * **appsec** = application security
                        * **netsec** = network security
                        * **physical security** = locks, alarm systems, protecting devices from being stolen
                    </section>
                    <section data-markdown>
                        ## AIC/CIA Triad
                        * Classic model for thinking about infosec
                        * Usually "CIA triad" but also "AIC triad"
                        * AIC = availability, integrity, confidentiality
                        * Availability = systems are online and accessible
                        * Integrity = data has not been modified and can be trusted
                        * Confidentiality = data is private
                        * Availability is often neglected in infosec, but you can't ensure integrity and confidentiality of data if the system is down.
                    </section>
                    <section data-markdown>
                        ## DevSecOps
                        * todo - bullet points on devops, secops, and devsecops
                    </section>
                    <section data-markdown>
                        ## Offense vs. Defense
                        * **Pentesting** = penetrationg testing - finding vulnerabilities in systems
                        * **Red team** = offensive team that pentests systems and breaks things
                        * **Blue team** = defensive team that protects systems and write secure systems
                    </section>
                    <section>
                        <h2>So Many Hats</h2>
                        <img alt="Archer wearing a gray hat, white hat, and black hat" src="img/hats.jpg" /><br/>
                        <small>Alex Hernandez, <a href="http://techaeris.com/2015/08/19/not-all-hackers-are-bad-short-guide-to-hacker-hat-colors/">Not All Hackers Are Bad – Short Guide To Hacker Hat Colors</a>, Techaeris</small>
                    </section>
                    <section data-markdown>
                        * **White hat** = ethical hacker, asks for permission, responsibly discloses vulnerabilities, possibly hired as a pentester
                        * **Black hat** = malicious, doesn't ask for permission, deletes data, asks victims for money
                        * **Gray hat** = nonchalant, may or may not ask for permission, may not report vulnerabilities at all or publicly discloses, hacks just for fun
                        * **Red Hat?** A type of Linux distribution
                    </section>
                    <section data-markdown>
                        ## Reporting Security Issues
                        * **Full disclosure** - researcher publishes blog post exposing an active security issue on a website or in a desktop application
                        * **Responsible/coordinated disclosure** - researcher notifies organization of security issue and public isn't notified until the organization releases a fix or a patch
                        * **Non-disclosure** - vulnerability information should never be shared with a vendor or only under an NDA
                        * **Bug bounty program** - structured program that encourages security researchers to pentest resources within scope and report security issues for money
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        # Consumer Security Quick Tips
                    </section>
                    <section data-markdown>
                        * This is worthy of its own "Intro to Consumer Security" talk.
                        * Instead I'll point up the most common security issues I see at work, at Meetups, and with friends and family and what you can do to secure your devices and accounts.
                        * Developers need to learn more than just how to write secure code.
                        * A compromised laptop, weak password, or posting credentials on GitHub can all lead to a breach.
                    </section>
                    <section data-markdown>
                        ["Verizon DBIR: Over Half Of Data Breaches Exploited Legitimate Passwords In 2015"](http://www.darkreading.com/endpoint/verizon-dbir-over-half-of-data-breaches-exploited-legitimate-passwords-in-2015/d/d-id/1325242)

                        ["In major goof, Uber stored sensitive database key on public GitHub page"](http://arstechnica.com/security/2015/03/in-major-goof-uber-stored-sensitive-database-key-on-public-github-page/)

                        ["US Healthworks Suffers Data Breach Via Unencrypted Laptop"](http://www.forbes.com/sites/davelewis/2015/06/01/us-healthworks-suffers-data-breach-via-unencrypted-laptop/#4f9f06897005)
                    </section> 
                    <section data-markdown>
                        ## Laptops
                        * Lock your screen when you step away from your laptop
                        * Use a complex password on your laptop and require a password on wake
                        * Encrypt your hard drive using FileVault (Mac), BitLocker (Windows), or LUKS (Linux)
                        * Enable a firewall on your computer
                        * Update your operating system and applications frequently, especially security patches
                    </section>
                    <section data-markdown>
                        ## Smartphones
                        * Use a long passcode on your smartphone (8+ characters)
                        * Android: don't use [common lock patterns](http://www.androidauthority.com/lock-pattern-predictable-636267/)
                        * Enable Find My iPhone or Android Device Manager (for remote wipe)
                        * Update your operating system and apps frequently, especially security patches
                    </section>
                    <section data-markdown>
                        ## Internet security
                        * Don't connect to unencrypted (passwordless) wifi networks
                        * If you must connect, use a VPN service
                        * Frequently update your web browsers
                        * Install HTTPS Everywhere browser plugin
                        * Install an ad blocker
                        * Enable click-to-play
                    </section>
                    <section data-markdown>
                        ## Account Security
                        * Use a strong password - [long (16+ characters) with special characters](https://www.technologyreview.com/s/542576/youve-been-misled-about-what-makes-a-good-password/)
                        * Even better, enable two-factor authentication (2FA) or two-step verification (2SV) on every account possible
                        * Use a password manager like [1Password](https://1password.com/) - use for all your passwords, 2FA tokens, credit cards, access tokens, and backup codes
                        * **Immediately store your 2FA backup or recovery codes in a safe place (password manager) after enabling 2FA**
                        * Don't provide real questions to security questions, store fake ones in a password manager - [2014 Yahoo! breach](https://www.wired.com/2016/09/time-kill-security-questions-answer-lies/)
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        # Developer Tools Security
                    </section>
                    <section data-markdown>
                        ## GitHub Account Security
                        * Enable 2FA on your GitHub account.
                        * Encourage your organization to make this required for all members.
                        * Best thing you can do to secure your GitHub account if not already enabled.
                        * Especially in light of recent [GitHub password reuse attack](http://www.theregister.co.uk/2016/06/16/github_accounts_breached_password_reuse_fail/).
                    </section>
                    <section data-markdown>
                        Help! I enabled 2FA and broke `git clone`!

                        * HTTPS - [create a personal access token](https://help.github.com/articles/creating-an-access-token-for-command-line-use/) (store in your password manager)
                        * Alternatively, [enable Git SSH authentication](https://help.github.com/articles/generating-an-ssh-key/)
                        * **Always use a strong passphrase to encrypt your SSH keys**
                        * A passphrase-less SSH key can be stolen by an attacker to impersonate you
                    </section>
                    <section data-markdown>
                        ## Code sample - Rotating SSH Keys

                        ```sh
                        # Backup current SSH keys
                        cp -a ~/.ssh ~/ssh-backup
                        # Generate new SSH key pair with a passphrase
                        ssh-keygen -t rsa -b 4096 -C "your_email@email.com" -f ~/.ssh/id_rsa
                        # Start the ssh-gent
                        eval "$(ssh-agent -s)"
                        # Add newly generated SSH key to the SSH agent and add to OS X Keychain
                        ssh-add -K ~/.ssh/id_rsa
                        ```
                        Full set of commands in `rotate-ssh-keys.sh` in `git-ssh` folder
                    </section>
                    <section data-markdown>
                        ### Repository Security
                        * Public vs. private repos
                        * Don't commit credentials or secret access tokens in your code
                        * **Public** access tokens for client-side JavaScript code can be checked in
                        * Store [sensitive information as environment variables](https://12factor.net/config) instead (even for private repos)
                    </section>
                    <section data-markdown>
                        * Use `git add &lt;file name&gt;` instead of `git add .`
                        * Don't post sensitive information in issues in public GitHub repos.
                        * Repo watchers will get the initial email with your sensitive information even if you later edit the comment on GitHub.com.
                    </section>
                    <section data-markdown>
                        ### Making Private Repos Public
                        * Look for open or closed issues with sensitive information - scrub comments
                        * Look for previous commits with sensitive information
                        * Use [BFG Repo Cleaner](https://rtyley.github.io/bfg-repo-cleaner/) to scrub sensitive data in the codebase.
                        * Look at every part of your code and ask yourself - could an attacker cause harm with this information?
                    </section>
                    <section data-markdown>
                        I posted something sensitive on GitHub!

                        * Take a deep breath.
                        * Just one commit on one branch? Delete the bad commit then force push.
                        * `git rebase -i HEAD~2` to interactive rebase the last 2 commits
                        * Delete the bad commit (`dd` in vim)
                        * Force push
                            * `git origin push &lt;branch name&gt; --force-with-lease`
                        * More than one commit? Check out [BFG Repo Cleaner](https://rtyley.github.io/bfg-repo-cleaner/).
                        * If credentials, revoke or rotate the compromised ones.
                    </section>
                    <section data-markdown>
                        # Gist Security
                        * Private vs. public gists
                        * Private Gists are **security by obscurity** - anyone with the URL can see
                        * Public Gists are posted to the top of the public [discover gists](https://gist.github.com/discover) page
                        * Hackers and black hats have tools to mine public Gists for access tokens and credentials
                        * Assume any sensitive information in a public Gist has been compromised
                        * If something is extremely sensitive, don't store it in a private Gist at all
                        * [Gist command line tools](https://github.com/defunkt/gist) are public by default - avoid using
                    </section>
                    <section data-markdown>
                        # Global `.gitignore`
                        * A robust global `.gitignore` file can help prevent accidentally checking in sensitive files
                    </section>
                    <section data-markdown>
                        # Travis CI security
                        * Encrypt secrets in your Travis CI configuration files
                    </section>
                    <section data-markdown>
                        # Node security
                        * Never run `sudo npm install`
                        * Instead install Node with a tool like nvm
                    </section>
                    <section data-markdown>
                        # Npm security
                        * Remove old contributors from your npm packages
                    </section>
                    <section data-markdown>
                        ## Dependency management
                        * Use up to date packages and dependencies in your code
                        * Automate using `nsp` or `retire.js`
                    </section>
                    <section data-markdown>
                        Mac - keep [Homebrew](http://brew.sh/index.html) package manager up to date

                        Update Homebrew to latest gitsha
                        ```sh
                        brew update
                        ```
                        View outdated packages
                        ```sh
                        brew outdated
                        ```
                        Upgrade package `foobar`
                        ```sh
                        brew upgrade foobar
                        ```
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        # Application Security

                        #### "AppSec"

                    </section>
                    <section data-markdown>
                        ## Golden rules of AppSec
                        * All user input is untrusted and potentially malicious
                        * Encrypt all the things
                        * Add reasonable limits
                        * Hash and salt passwords
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        # Encrypt all the things

                        ## SSL/TLS
                    </section>
                    <section data-markdown>
                        ## `https://`
                        * HTTP Secure or HTTP over SSL/TLS
                        * SSL/TLS = Secure Socket Layer/Transport Layer Security
                        * Port 443 by default
                        * Encrypts all data in transit between client &amp; server
                        * Privacy, authentication, and integrity of data
                    </section>
                    <section data-markdown>
                        ## PKI Primer
                        * PKI = Public Key Infrastructure
                        * HTTPS uses PKI, specifically asymmetric public key cryptography
                        * Asymmetric = private keys (secret) and public keys (shared)
                        * Keys shared with secure key exchange algorithms (RSA, Diffie-Hellmen, elliptical curve)
                        * Digital certificates issued by certificate authorities verify identity
                    </section>
                    <section data-markdown>
                        ## How do you configure SSL/TLS?
                        * Buy a certificate from a Certificate Authority (CA)
                            * Domain Validated (DV), Organization Validated (OV), Extended Validation (EV) 
                        * [Let's Encrypt](https://letsencrypt.org/)
                            * Free, automated, and open CA
                            * Requires shell access to server
                            * Won't work on GitHub Pages websites :(
                        * Development use only - self-signed certificates
                    </section>
                    <section data-markdown>
                        ## Code sample

                        Follow along with the code sample in the `http-server` directory

                        Requires Node v4.6.0 and npm v2.15.19

                        ```sh
                        git clone git@github.com:alulsh/intro-to-security-for-developers.git
                        cd https-server
                        npm install
                        ```
                    </section>
                    <section data-markdown>
                        ## Generate a self-signed cert with OpenSSL

                        OpenSSL `req` command to generate a certificate signing request (CSR)

                        ```sh
                        openssl req -x509 -newkey rsa:2048 -keyout privatekey.pem -out cert.pem -days 365 -subj '/C=US/ST=DC/O=MyOrganization' -nodes
                        ```
                    </section>
                    <section data-markdown>
                        * `-x509` - output self-signed certificate instead of CSR
                        * `-newkey rsa:2048` - 2048 bit RSA private key
                        * `-keyout privatekey.pem` - private key
                        * `-out cert.pem` - self signed certificate
                        * `-subj` - subject name for certificate
                        * `-days 365` - key is valid for a year
                        * `-nodes` - private key is un-encrypted without a passphrase (**development only**)
                    </section>
                    <section data-markdown>
                        Add to your app's `package.json` as a script

                        ```js
                          "scripts": {
                            "cert": "openssl req -x509 -newkey rsa:2048 -keyout privatekey.pem -out cert.pem -days 365 -subj '/C=US/ST=DC/O=MyOrganization' -nodes",
                          },
                        ```

                        To generate new self-signed certs for development:
                        ```sh
                        npm run cert
                        ```

                        You should see two new files - `privatekey.pem` and `cert.pem`
                    </section>
                    <section data-markdown>
                        ## Simple HTTPS Express server
                        ```js
                        var express = require('express');
                        var https = require('https');
                        var fs = require('fs');
                        var app = express();

                        var options = {
                            key: fs.readFileSync('privatekey.pem'),
                            cert: fs.readFileSync('cert.pem')
                        }

                        https.createServer(options, app).listen(4000, function(err){
                            if (err) throw err;
                            console.log('Server started on port 4000');
                        });

                        app.get('/', function (req, res) {
                            res.header('Content-type', 'text/html');
                            return res.end('&lt;h1&gt;Served over HTTPS&lt;/h1&gt;');
                        });
                        ```

                        From `https-server` folder, run `npm start` command, then visit `https://localhost:4000/`
                    </section>
                    <section data-markdown>
                        ## SSL vs TLS
                        * SSL/TLS handshake to determine which versions of SSL or TLS
                        * All versions of SSL (1.0, 2.0, and 3.0) are insecure
                        * Disable all versions of SSL on your servers &amp; clients (browsers)
                        * Instead use TLS, preferably TLS 1.2
                        * Visit [https://www.howsmyssl.com/](How's My SSL?) to test your browser's SSL/TLS security
                    </section>
                    <section data-markdown>
                        ## SSL/TLS Exploits
                        * POODLE - SSLv3 downgrade exploit, later [certain TLS implementations](https://blog.qualys.com/ssllabs/2014/12/08/poodle-bites-tls)
                        * [Heartbleed](https://en.wikipedia.org/wiki/Heartbleed) - OpenSSL vulnerability
                        * [DROWN](https://en.wikipedia.org/wiki/DROWN_attack) - TLS vulnerability that exploited SSLv2 legacy support
                        * **Disable old versions of SSL and TLS if possible**
                    </section>
                    <section data-markdown>
                        ## Mixed content
                        * HTTPS page contains HTTP content - images, scripts, iframes
                        * The connection is now only **partially encrypted** - less privacy
                        * Victims subject to sniffing or man-in-the-middle attacks
                    </section>
                    <section data-markdown>
                        * Passive mixed content
                            * `&lt;img&gt;`, `&lt;audio&gt;`, `&lt;video&gt;`
                            * Less harmful, attacker can only replace images
                        * Active mixed content
                            * `&lt;script&gt;`, `&lt;link&gt;`, `XMLHttpRequest`
                            * Harmful, attacker can replace with malicious scripts!
                        * Good write up on [Mozilla Developer Network](https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content)
                    </section>
                    <section data-markdown>
                        ## Code sample
                        Follow along with the code sample in the `mixed-content` directory

                        ```sh
                        git clone git@github.com:alulsh/intro-to-security-for-developers.git
                        cd mixed-content
                        npm install
                        npm start
                        ```
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        # Cross-Site Scripting (XSS)
                    </section>
                    <section data-markdown>
                        ## What's XSS?
                        * Attackers injecting malicious code, usually JavaScript, into your website
                        * XSS payload = malicious code or JavaScript
                        * Treating user-provided data or input as trusted and not potentially malicious
                        * "Failure to separate data from instructions" - ["A Gentle Introduction to Application Security"](https://paragonie.com/blog/2015/08/gentle-introduction-application-security) from Paragon Initiative
                    </section>
                    <section data-markdown>
                        ## How malicious is JavaScript, anyway?
                        * Stealing cookies (access to `document.cookie`)
                        * Keyloggers (`addEventListener`)
                        * Phishing (create fake login forms)
                        * Capturing screenshots of user's session
                        * More scary XSS payloads at [xss-payloads.com](http://www.xss-payloads.com/payloads.html)
                    </section>
                    <section data-markdown>
                        ## Types of XSS

                        * Where is the vulnerable code?
                            * Server-side - server XSS
                            * Client-side - client XSS or DOM-based XSS
                        * How is the payload triggered?
                            * Stored or persistent XSS
                            * Reflected XSS
                            * Self-XSS
                    </section>
                    <section data-markdown>
                        ### Stored XSS
                        * Attacker injects script into a website's database
                        * e.g. attacker pastes payload into a comment on a forum, which is saved in the thread
                        * Malicious JavaScript executed **every time victims visit the page**
                        * Usually server XSS, unable to find real life stored client XSS examples (if you know one, tell me!)
                        * Real life example - [Stored XSS in Veris member portal](https://hackerone.com/reports/118950)
                        * Payload - `&lt;svg onload=alert(1)&gt;`
                    </section>
                    <section data-markdown>
                        ### Reflected XSS
                        * Victim clicks on link crafted to execute payload on page load, e.g. link in a phishing email or social media post
                        * Either server XSS or client XSS
                        * Real-life example - [Reflected XSS in scores.ubnt.com](https://hackerone.com/reports/130889)
                        * Payload - `https://scores.ubnt.com/form.html?uid=1&amp;p=airFiber"&gt;&lt;script&gt;alert(document.cookie);&lt;/script&gt;`
                    </section>
                    <section data-markdown>
                        ### Client XSS
                        * Also referred to as DOM-based XSS
                        * Insecure client-side JavaScript code
                        * Often but not always also reflected XSS
                        * Commonly seen with insecure use of `innerHTML` or templates (underscore, EJS)
                    </section>
                    <section data-markdown>
                        ### Code samples
                        Follow along with the code sample in the `xss` directory

                        ```sh
                        git clone git@github.com:alulsh/intro-to-security-for-developers.git
                        cd xss
                        npm install
                        npm start
                        ```
                        Visit `http://localhost:3000/` in your browser
                    </section>
                    <section data-markdown>
                        ### Malicious images
                        * Payload from code sample - `http://localhost:3000/results.html?query=&lt;img src="fake.jpg" onerror=alert(1)&gt;`
                        * Websites may block `&lt;script&gt;` tags, but may allow rich HTML content including `&lt;img&gt;` and `&lt;svg&gt;`
                        * `onerror` attribute executes JavaScript when image fails to load
                    </section>
                    <section data-markdown>
                        ### Incomplete list of client XSS payloads
                        * `javascript:` protocol - `&lt;IMG SRC=javascript:alert('XSS')&gt;`
                        * body tag - `&lt;BODY ONLOAD=alert('XSS')&gt;`
                        * link tag - `&lt;LINK REL="stylesheet" HREF="javascript:alert('XSS');"&gt;`
                        * CSS URLs - `&lt;DIV STYLE="background-image: url(javascript:alert('XSS'))"&gt;`
                        * [Markdown parsers](https://hackerone.com/reports/82725) - `[Click here](javascript:alert(1))`
                    </section>
                    <section data-markdown>
                        ### Even more payloads
                        * OWASP's awesomely long [XSS Filter Evasion Cheat Sheet](https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet)
                        * [HTML5 Security Checklist](https://html5sec.org/)
                        * [XSS Hunter](https://xsshunter.com/) for XSS pentesting (ask for permission before using)
                    </section>
                    <section data-markdown>
                        ### How to prevent client XSS
                        <!-- To Do: Explain HTML escaping -->
                        * HTML escape user provided data before adding to the DOM
                        * HTML escaping &gt; sanitization
                        * Attackers will find ways to get around sanitization libraries
                        * Recommend [lodash escape function](https://lodash.com/docs/4.16.3#escape) `_.escape()`
                        * Don't use `textContent` or `createTextNode` to [escape HTML](http://benv.ca/2012/10/02/you-are-probably-misusing-DOM-text-methods/)
                        * Use HTML escaped [interpolation](https://en.wikipedia.org/wiki/String_interpolation) templates, as seen in [underscore](http://underscorejs.org/#template)
                            * `&lt;%-` instead of `&lt;%=` or `<%`
                            * Real-life example: [Reflected cross-site scripting (XSS) on api.tiles.mapbox.com](https://hackerone.com/reports/135217)
                    </section>
                    <section data-markdown>
                        ### More client XSS mitigations
                        * [Quote your HTML attribute values](http://wonko.com/post/html-escaping)
                            * `&lt;a href="url"` not `&lt;a href=url`
                        * Avoid using `innerHTML` to add user-provided data to the DOM
                            * Instead create the DOM elements manually (_artisanal DOM elements_)
                            * Real life example: [XSS in L.mapbox.shareControl in mapbox.js](https://hackerone.com/reports/99245)
                            * [mapbox.js pull request #1102](https://github.com/mapbox/mapbox.js/pull/1102/files)
                        * Use `X-XSS-Protection` and Content Security Policy headers
                    </section>
                    <section data-markdown>
                        ### Self-XSS
                        ![Facebook self XSS warning](img/FacebookSelfXSS.png)
                    </section>
                    <section data-markdown>
                        ## XSS Resources
                        * [Excess XSS, A comprehensive tutorial on cross-site scripting](http://excess-xss.com/)
                        * [XSS Game by Google](https://xss-game.appspot.com/)
                        * [OWASP XSS Prevention Cheat Sheet](https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet)
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        # Authentication Systems
                    </section>
                    <section data-markdown>
                        ## Passport Module
                    </section>
                    <section data-markdown>
                        ## Password security
                        * Salt and hash passwords with bcrypt
                        * learn-bcrypt folder on computer
                    </section>
                    <section data-markdown>
                        ## Secure cookies
                        * What is a cookie?
                        * Secure and httpOnly flags
                        * dangers of localstorage - https://michael-coates.blogspot.com/2010/07/html5-local-storage-and-xss.html
                    </section>
                    <section data-markdown>
                        ## CSRF
                        * csurf express middleware
                    </section>
                    <section data-markdown>
                        ## oAuth security
                        * Use the `state` parameter when building oAuth solutions
                        <!-- TODO code sameple for adding state parameter - passport module -->
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        ## Information Disclosure

                        Revealing more information than necessary about the configuration of your system or software.
                    </section>
                    <section data-markdown>
                        ## Fingerprinting
                        * Before attacking a target, attackers will try to find out as much information as possible via **fingerprinting**.
                        * Easier to hack a system if you know it's architecture or what software it's running
                        * Easier to social engineer a company if you know the people in it
                        * Attackers get info from your website, blog posts, employees social media posts, open source code, and HTTP headers.
                    </section>
                    <section data-markdown>
                        ## Banner Grabbing
                        * Finding out website software and architecture information from HTTP headers
                        * Command line tools like `nc` (netcat) or `curl`
                        ```sh
                        curl -I www.alexandra.ulsh
                        ```
                        * Response includes `X-GitHub-Request-Id: 17EB2E2E:40D2:191BAD2C:57F7AFBE`
                        * Attacker now knows it's a GitHub Pages site
                        * Programmatic information disclosure is particularly dangerous - attackers can automate attacks
                    </section>
                    <section data-markdown>
                        ## Preventing Information Disclosure
                        * Disable HTTP headers that reveal software names and versions.
                        * There is no benefit to leaving these headers up, and removing them may even benefit performance.
                        * Don't run production servers in debug or verbose mode
                        * Don't display stack traces or detailed errors to users
                        * Don't leave sensitive information in HTML or JavaScript comments
                            * staging/test endpoints, credentials, private IP addresses, workarounds
                    </section>
                    <section data-markdown>
                        ## Preventing Disclosure in Express
                        * By default Express displays the `X-Powered-By: Express` header
                        * Disable using `app.disable('x-powered-by');`
                        * The default cookie name in Express is `connect.sid`
                        * Use a generic name like `session` instead of the default name
                        ```js
                        app.use(session({
                            secret: 't0ps3cr3t',
                            name: 'session'
                            })
                        );
                        ```
                        <!-- Possible to do: code sample and example with X-Powered-By header -->
                        <!-- Possible to do: code sample with non-default cookie name -->
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        # Protecting Availability
                    </section>
                    <section data-markdown>
                        ## Denial of Service (DoS)
                        * Taking a system offline and rendering it unavailable to its users
                        * Can be triggered by one illogical payload or multiple high-volume requests
                        * Real life example: [Denial of service in account statistics endpoint](https://hackerone.com/reports/136221)
                        * DoS condition triggered by requesting a large period of time for account statistics - 20 years of (non-existent) data!
                        * Resolved by adding a limit to endpoint to not request more than a year of data
                    </section>
                    <section data-markdown>
                        ## Validating Input
                        * To mitigate DoS conditions, validate user input and add reasonable limits to your application logic.
                        * Don't allow users to provide or request:
                            * data from unlimited time periods
                            * negative values
                            * strings when it should be a number
                            * code or specal characters (null bytes) when it should be text
                        * Limit the size of user uploads (e.g. 20mb)
                        * Build resilient, scalable systems that stay online when 1 server goes offline
                    </section>
                    <section data-markdown>
                        ## Distributed Denial of Service (DDoS)
                        * DoS attacks distributed across multiple machines or attackers, often as part of a **botnet**
                        * Internet hosting company OVH suffered 1 terabyte DDoS attack - [the largest ever so far](http://www.scmagazineuk.com/ovh-suffers-11tbps-ddos-attack/article/524826/)
                        * Botnet of CCTV &amp; IoT devices with weak passwords launched attack
                        * Types of attacks: UDP flood, SYN flood, ping of death, DNS reflection
                    </section>
                    <section data-markdown>
                        ## Attacker motivations
                        * geopolitical - [NATO &amp; Ukraine DDoS](http://www.darkreading.com/attacks-and-breaches/ddos-attacks-hit-nato-ukrainian-media-outlets/d/d-id/1127742))
                        * censoring activist movements - DDoS against Black Lives Matter
                        * extortion - pay us money and we'll stop the attack
                        * just because - [Lizard Squad](http://www.bbc.co.uk/newsbeat/article/30306319/who-are-lizard-squad-and-whats-next-for-the-hackers) 
                    </section>
                    <section data-markdown>
                        ## Mitigating DDoS
                        * Sign up for a DDoS protection service
                        * [CloudFlare](https://www.cloudflare.com/ddos/)
                        * [Akamai](https://www.akamai.com/us/en/solutions/products/cloud-security/ddos-protection-service.jsp)
                        * AWS WAF (web application firewall) + AWS CloudFront (CDN) - [see AWS DDoS whitepaper](https://d0.awsstatic.com/whitepapers/Security/DDoS_White_Paper.pdf)
                        * [Deflect](https://deflect.ca/) - free anti-DDoS service "for independent media, human rights organisations and activists"
                    </section>
                    <section data-markdown>
                        ## Brute Force Attacks
                        * Attacking an application's login endpoint in order to crack a user's password and take over their account
                        * Hackers use tools like [Burp Suite](https://support.portswigger.net/customer/portal/articles/1964020-using-burp-to-brute-force-a-login-page) to load a dictionary of possible passwords
                        * Offline brute force attacks can be used to guess computer login passwords using [rainbow tables](https://en.wikipedia.org/wiki/Rainbow_table) and tools like [John the Ripper](https://en.wikipedia.org/wiki/John_the_Ripper)
                    </section>
                    <section data-markdown>
                        ## Brute Force Mitigations
                        * Account lockout - account locks out after specified number of bad logins
                        * CAPTCHA - human completes CAPTCHA before logging in
                        * Rate limit - limit requests to endpoint to 10 request/minute (ok for humans)
                        * Account lockout not desirable as this prevents legitimate users from accessing their account
                        * Also allows attackers to intentionally lockout victims
                    </section>
                    <section data-markdown>
                        ## Rate Limiting
                        * Wealth of rate limiting libraries for Node and Express
                        * Check out [express-rate-limit](https://github.com/nfriedly/express-rate-limit) and [express-brute](https://www.npmjs.com/package/express-brute)
                        * Example code to prevent brute force on login endpoint:
                            ```js
                            var RateLimit = require('express-rate-limit');

                            var loginLimiter = new RateLimit({
                              windowMs: 60*1000, // 1 minute
                              max: 10,
                              delayMs: 0 // disabled
                            });

                            app.post('/login', loginLimiter, function(req, res) {
                                // rest of login code here
                            });;
                            ```
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        ## Security Headers
                    </section>
                    <section data-markdown>
                        ## Expressjs helmet module
                        * https://helmetjs.github.io/
                        * https://github.com/helmetjs/helmet
                    </section>
                    <section data-markdown>
                        ## Content Security Policy (CSP)
                    </section>
                    <section data-markdown>
                        ## Common security headers
                        * CSP - https://developers.google.com/web/fundamentals/security/csp/
                    </section>
                    <section data-markdown>
                        ## HSTS
                        * PKP (public-key pinning)
                    </section>
                </section>
                <section>
                    <section data-markdown>
                        # Infrastructure Security
                    </section>
                    <section data-markdown>
                        ## DevSecOps
                        * Don’t run processes as root or admin
                        * Service accounts should have strong complex passwords
                        * Update your operating systems and apply patches
                        * Disable directory listing
                        * Limit size of file uploads
                    <section data-markdown>
                        ## AWS security
                        * Don't enable directory listing on buckets
                    </section>
                </section>
                <section data-markdown>
                    ## More Security Topics
                    This presentation covers a limited set of topics in security, I highly encourage you to explore even more! Here's an incomplete list:

                    * Cryptography
                    * Forensics
                    * Compliance
                    * Social engineering
                    * Lock picking
                    * Clickjacking (UI redressing)
                    * Content spoofing
                    * Open redirects
                    * Phishing
                    * SQL Injection and NoSQL Injection
                    * Remote code execution (RCE)
                    * XML Entity Expansion ("A billion laughs")
                </section>
                <section data-markdown>
                    ## Resources
                    * [Hacksplaining](https://www.hacksplaining.com/)
                    * [Node.js security checklist](https://blog.risingstack.com/node-js-security-checklist/)
                    * [A Gentle Introduction to Application Security](https://paragonie.com/blog/2015/08/gentle-introduction-application-security)
                    * [Security Checklist for Developers](https://github.com/FallibleInc/security-guide-for-developers/blob/master/security-checklist.md)
                    * [Express Production Best Pracices: Security](http://expressjs.com/en/advanced/best-practice-security.html)
                    * [DVWA - Damn Vulnerable Web App](https://github.com/ethicalhack3r/DVWA)
                    * [Facebooks Capture the Flag](https://github.com/facebook/fbctf)
                </section>
            </div>
        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.js"></script>

        <script>
            // More info https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                history: true,

                // More info https://github.com/hakimel/reveal.js#dependencies
                dependencies: [
                    { src: 'plugin/markdown/marked.js' },
                    { src: 'plugin/markdown/markdown.js' },
                    { src: 'plugin/notes/notes.js', async: true },
                    { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
                ]
            });
        </script>
    </body>
</html>
